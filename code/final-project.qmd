---
title: "bst260-final"
format: html
eval: true
---

BST 260 Final Project

Harshi Saha, Jurijs Alehins, Tanush Kumar

### Examining Mortality Trends in Puerto Rico: Demographic Patterns and the Impact of Hurricane Maria

**Abstract:**

The objective of this study is to examine mortality trends in Puerto Rico 


**Introduction:**

Understanding the changes in a population in response to a variety of factors, such as disease outbreaks, natural disasters, and socioeconomic collapse, is critical in guiding public health actions related to emergency response, policy decisions, and recovery efforts. A valuable metric to assess the extent of change is a population in the aftermath of an impactful event is mortality, as it is a measurable outcome that is directly representative of a negative change in the population of interest. Incidents that affect a population and that require public health responses can affect mortality both directly and indirectly, and the changes in the population in response to the incident, in terms of mortality, is highly specific to the nature of incident itself. Despite, and perhaps on account of the complexity posed by this characteristic of the measure of mortality, it is essential to develop methods to estimate mortality. Building on these estimations, excess mortality, the difference between the observed and expected number of deaths of a population, can be used as an indicator of the impact of public health crises and can guide policy and action as a response.

Estimating excess mortality is complicated by the presence of several influencing factors, such as changes in the population structure by demographic factors, seasonal fluctuations associated with disease, and other underlying trends in mortality. Moreover, major calamities can massively effect excess mortality, and the trend can be dependent on the type of event. For example, after a natural disaster such as a hurricane we generally see a spike in excess mortality. On the other hand, during epidemics we see a gradual rise in excess mortality, and then a gradual decline. In addition, the effects of such an event may vary by different groupings of the population of interest, making it necessary to adjust for variables such as age and sex. Though useful, methods of estimating excess mortality relying solely on trends in historical data fail to account for these sources of variability, in addition to inherently being unable to adapt estimations to distinct public health crises. However, they serve as a valuable tool to quantify the effect of such events on excess mortality for different demographic groups.

In this project, we attempt to model excess mortality in Puerto Rico in 2017 and 2018. We attempt to address some of the limitations of traditional modeling methods by using Poisson models to flexibly account for variability and the factors affecting mortality as mentioned above. We use the dataset `puerto_rico_counts` derived from the `excess_mort` package published as part of a related [study](https://pmc.ncbi.nlm.nih.gov/articles/PMC10200579/), representing the records of mortality in Puerto Rico from 1985 to 2022.

Hurricane Maria was a powerful hurricane that devastated the northeast Carribean, including Puerto Rico, resulting in a death count of 2,975 people. We use our model to estimate excess mortality to estimate the impact of Hurricane Maria on the population. Through the model, we gain valuable insights on the impact of the hurricane on different demographic groups, specifically by age and sex.

**Methods:**

The source of the data for the majority of the analysis outlined in this report is the `excessmort` package, which has been utilized in and made available through a [study](https://pmc.ncbi.nlm.nih.gov/articles/PMC10200579/) using statistical methods to estimate excess mortality. The [`excessmort`](https://cran.r-project.org/web/packages/excessmort/) package was published in November of 2024, and contains the variable `puerto_rico_counts`, which is the data frame of interest for this study. The data frame contains 499,644 rows and 5 columns, which are `agegroup`, `date`, `sex`, `population`, and `outcome`, and the data ranges from January 1 of 1985, to December 31 of 2022. The `outcome` column represents the number of deaths for members of the corresponding age group and sex, in Puerto Rico, on the specified date, while the `population` column represents the number of individuals of the specified age group and sex, in Puerto Rico, on the specified date. The number of the `week` for each observation was redefined using the start day of Wednesday, as this is the day that Hurricane Maria made landfall, and this approach will prevent the immediate effect of the Hurricane in the first week of landfall from being split across two weeks in the data set. The data set contained daily count of deaths, and these were aggregate over for each week, by age and sex, in order to get the weekly mortalities such that the outcome was defined with one row for each combination of `week`, `age`, and `sex`. 

The `puerto_rico_counts` data frame was examined for patterns of changes in population size by `age` and `sex`. First, a line graph was made using the raw counts of the total population, using the mean population for each week grouped by age and sex, from 1985 to 2022. Then, a line graph was made using the proportions of the total population, using the mean population for each week grouped by age groups, such that Child represented ages 0-19, Adult represented ages 20-44, Older Adult represented ages 45-64, and Senior Citizens represented ages 65 and above, and sex, from 1985 to 2022. The mortality rate was calculated by dividing the total grouped deaths by the average of the population grouped by age and sex for each week. 

Based on the above, age groups with similar death rates were combined into larger groups, specifically, ages 5-14, 20-29, 30-44 were combined to create a new column `age_group_category` such that the values in the `age_group_category` column were 0-4, 5-14, 15-19, 20-29, 30-44, 45-49, 50-54, 55-59, 60-64, 70-74, 75-79, 80-84, and 85 and above.To account for the time dependent mortality trends across the years, a variables called `day` was created that described the number of days passed from the first day described in the data set, for each week. The features `day` and `age_group_category` were added to the `puerto_rico_counts` data set.

Since the outcome for this study, encoded by the `outcome` variable in `puerto_rico_counts`, is the number of mortalities, which is a count, the model of choice is Poisson Regression. The offset was set to `log(population)` to account for the risk of death relative to the size of the population. The covariates investigated in the model building process, from the `puerto_rico_counts` data set, were `age_group_category`, `sex`, `week`, `day`. Models were initially fit for 1985 to 2016 with and without one of `day` and `week`, and AIC and Likelihood Ratio Tests indicated that both variables should be included in the model. Additionally, effect modification was assessed between `age_group_category` and `week`, `sex` and `week`, `age_group_category` and `sex`, and `age_group_category` and `day`, and AIC and Likelihood Ratio Tests indicated that only the `age_group_category`-`day`
and the `age_group_category`-`sex` interaction terms were significant. The data indicated slight signs of overdispersion, so an alternate model was fit using Negative Binomial Regression, however AIC indicated that the model fit was much worse than the Poisson model. 

Therefore, the final model chosen to estimate mortality was a Poisson regression model with an offset of `log(population)` with `outcome`, the number of deaths, estimated using `age_group_category`, `sex`, `week`, `day`, `age_group_category\*sex` and ` day\*age_group_category`. The expected mortality was calculated using this fitted model spanning 1985 to 2017 in the data set, and the standard deviation was calculated for each prediction. To identify periods from 1985 to 2017 having excess mortality to be investigated, weeks with actual mortality over 3 times the standard deviation of the estimated mortality were selected, and were then selected if the total excess mortality across age groups and sex for the identified weeks were greater than 100. These weeks were then cross-referenced with dates on which actual mortality increasing events of interest occurred in Puerto Rico. Selected observations that were identified as being associated with catastrophic events were dropped from the data set, after which the Poisson model chosen above was fitted again on the data set, form 1985 to 2017, with these outliers removed. This fitted model was then used to estimate mortality, and in turn calculate estimated excess mortality, for 2017 and 2018, and trends in mortality by age and sex, and especially around landfall of Hurricane Maria, were looked into.

Additionally, the data for the counts of deaths in Puerto Rico contained in the `excessmort` package was compared with data in the Demographic Registry - Quality and Vital Statistics Division as presented by the [New York Times](https://github.com/c2-d2/pr_mort_official/raw/master/data/Mortalidad-RegDem-2015-17-NYT-part1.pdf). This data was obtained and wrangled using the `pdftools` packages in R, and the specific code used to do so is contained in the file `pdf_extract.qmd` in the `code` directory. The extracted and cleaned data used can be found in the `excess_mort.csv` in the `data` directory. Specifically, the New York Times data regarding the number of deaths in Puerto Rico by year and month have been aggregated, from January of 2015 to November of 2017, and the data does not display any missingness. 

**Code for the data cleaning and analysis methods outlined here can be found in the file `code.R` in the code directory.**

**Results:**

In examining the population sizes of Puerto Rico by age group and sex, as seen in Figure 1, from 1985 to 2002, the population of individuals in the age groups 0-24 display a sharp decrease, while the population of individuals in the age groups 65 and above increased, for both sexes. For the individuals in the age groups with ages between 24 and 65 however, the population size appears to increase and then slightly decrease for both sexes. When grouping individuals by age, such that Child represented ages 0-19, Adult represented ages 20-44, Older Adult represented ages 45-64, and Senior Citizens represented ages 65 and above, as in Figure 2, it appears that the population of Children decreased drastically, and almost in a manner symmetrically opposite to the drastic increase in the proportion of Senior Citizens, and the proportion of Adults and Older Adults appear to decrease and increase respectfully towards a similar proportion, for both sexes. Examining the weekly mortality rate by age and sex indicated similarities in death rate for the ages  5-14, 20-29, and 30-44, with the lowest death rates being from ages 5-14 and the highest death rates being from ages 70 and above, as indicated in Figure 3.


In order to identify periods before and during 2017 with an excess mortality, several Poisson models were evaluated and fit, and the final chosen model was then used to calculate estimates and standard deviations of estimated mortality for each week. Weeks with an observed mortality 100 above the estimate, combined across age group and sex, were identified as having excess mortalities to be investigated. The weeks extracted here were 29, 3 of which corresponded to Hurricane Maria, and at least 4 of which aligned with Hurricane Georges. After dropping observations corresponding to the weeks of and close to these dates, as they were determined to have excess mortality influencing the model, the model was refitted to compute expected death rates. 

...

Upon comparison of the data from the `excessmort` package and the New York Times Report of the [Demographic Registry - Quality and Vital Statistics Division](https://github.com/c2-d2/pr_mort_official/raw/master/data/Mortalidad-RegDem-2015-17-NYT-part1.pdf) for the total number of deaths in Puerto Rico from 2015 to 2017, aggregated by year and month, it was found that the New York Times understated the number deaths overall. The total difference between the deaths reported by `excessmort` and the New York Times was 1328, with the largest difference being in November of 2017 at 1018, and the discrepancies in the reported number of deaths from the two data sources is visualized in the table below (Table 1):

![](./../data/count_comparison.png)

**Discussion:**

Based on the comparison of the population sizes of Puerto Rico by age group and sex as well the comparison of population sizes by aggregated age groups for Children, Adults, Older Adults, and Senior Citizens, the data indicates an aging population in Puerto Rico. From 1985 to 2022, the data indicates that the life expectancy increase, likely due to a combination of improved living conditions and medical advancements, and relative fertility has decreased. The middle aged population appears somewhat stable, suggesting a buffer population that supports individuals of the population in both the younger and older age groups. Calculations of the weekly death rate by age group and sex from 1985 to 2002 in the data set indicate that those of the ages 5-14, 20-29, and 30-44 had similar rates of mortality, and that the lowest death rates were observed for those of ages 5-14 and the highest death rates were observed for those of ages 70 and above. These trends in mortality rate for children and Young to Middle Aged Adults are likely due to reduced infant mortality and improvements in health care, and the trends for Older Adults and Senior Citizens can be attributed to age related chronic conditions. 





Furthermore, as described in the results section, the largest discrepancy in the count of deaths between the `excessmort` package and the New York Times report is in November of 2017, with 1018 deaths being underreported. As the New York Times Report does not include deaths for December of 2017, this report was likely compiled in or around December of 2017. Additionally, the discrepancies between the two data sources (`excessmort` - NYT) is positive and starts increasing from September to November of 2017. This increase in the discrepancy can be attributed to Hurricane Maria as well as the time at which the NYT report was likely compiled, as the updating of the death toll would have been slow and inaccurate in the wake of such a catastrophic natural disaster.
